---
parameters:
  - name: force
    type: boolean
    default: false
  - name: tag
    type: string

steps:
  - ${{ if parameters.force }}:
      - bash: |
          set -euo pipefail

          git tag -a "${{ parameters.tag }}" -m "${{ parameters.tag }}" --force
          git push --tags --force
          echo "##vso[build.addbuildtag]${{ parameters.tag }}"
        displayName: Add tag
  - ${{ else }}:
      - bash: |
          set -euo pipefail

          git tag -a "${{ parameters.tag }}" -m "${{ parameters.tag }}"
          git push --tags
        displayName: Add tag
