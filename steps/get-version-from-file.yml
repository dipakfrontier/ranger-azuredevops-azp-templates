---
steps:
  - pwsh: |
      $Version = Get-Content (Join-Path "$(System.DefaultWorkingDirectory)" -ChildPath "VERSION")
      if (!$Version) { Throw "Unable to get version from file" }
      if (!$Version -match '^(\d+\.\d+)$') { Throw "Version in file does not match format [major].[minor]" }
      Write-Host "$Version"
      Write-Host ($Version -match '^(\d+\.\d+)$')
      Write-Host "##vso[task.setvariable variable=version]$Version"
      Write-Host "##vso[task.setvariable variable=version;isOutput=true]$Version"
    name: getVersionFromFile
    displayName: Get version from file
