---
parameters:
  - name: pipelineCounter
    type: string
  - name: versionFromFile
    type: string
  - name: versionLabel
    type: string

steps:
  - pwsh: |
      $VersionFromFile = "${{ parameters.versionFromFile }}"
      if ($VersionFromFile -notmatch '^(\d+\.\d+)$') { Throw "Version from file does not match format [major].[minor]" }
      $Version = "${{ parameters.versionFromFile }}.${{ parameters.pipelineCounter }}${{ parameters.versionLabel }}"
      Write-Host "$Version"
      Write-Host "##vso[task.setvariable variable=version]$Version"
      Write-Host "##vso[task.setvariable variable=version;isOutput=true]$Version"
    name: setVersionVariable
    displayName: Set version variable
